(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{ihKv:function(e,a,t){"use strict";t.r(a);t("+L6B");var l,n,r,i,o=t("2/Rp"),s=(t("iQDF"),t("+eQT")),m=(t("BoS7"),t("Sdc0")),c=(t("2qtc"),t("kLXV")),d=(t("DZo9"),t("8z0m")),u=(t("sRBo"),t("kaz8")),p=(t("giR+"),t("fyUT")),h=t("jehZ"),E=t.n(h),g=(t("miYZ"),t("tsqr")),f=(t("Pwec"),t("CtXQ")),y=t("d6i3"),v=t.n(y),b=t("1l/V"),w=t.n(b),I=t("p0pE"),B=t.n(I),k=t("2Taf"),N=t.n(k),C=t("vZ4D"),L=t.n(C),S=t("l4Ni"),x=t.n(S),V=t("ujKo"),D=t.n(V),M=t("MhPg"),T=t.n(M),z=(t("y8nQ"),t("Vl3Y")),P=(t("7Kak"),t("9yH6")),H=(t("OaEy"),t("2fM7")),R=(t("Znn+"),t("ZTPi")),Y=(t("5NDa"),t("5rEg")),_=t("q1tI"),q=t.n(_),O=t("MuoO"),U=t("MUX8"),Z=t.n(U),j=t("zHco"),F=t("yEr3"),X=t.n(F),A=(t("Lzxq"),t("wd/R")),J=t.n(A),K=(t("XDpg"),t("Z0Lh")),Q=t.n(K);J.a.locale("zh-cn");var G=Y["a"].TextArea,W=R["a"].TabPane,$=H["a"].Option,ee=P["a"].Group,ae=(l=Object(O["connect"])(function(e){var a=e.model;return{model:a}}),n=z["a"].create(),l(r=n((i=function(e){function a(){var e,t;N()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return t=x()(this,(e=D()(a)).call.apply(e,[this].concat(n))),t.modelName="page",t.state={msg:"",url:"",previewVisible:!1,previewImage:"",coverList:[],data:{categorys:[],file_id:null,file_name:null,file_path:null},status:"",pagination:{},loading:!1},t.handleCancel=function(){return t.setState({previewVisible:!1})},t.handlePreview=function(e){t.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})},t.handleSubmit=function(e){e.preventDefault(),t.props.form.validateFields(function(e,a){a.created_at=a.created_at.format("YYYY-MM-DD HH:mm:ss"),a.content=t.state.data.content;var l=[];t.state.coverList.map(function(e){l.push(e.uid)}),a.cover_ids=JSON.stringify(l),e||t.props.dispatch({type:"model/store",payload:B()({modelName:t.modelName},a)})})},t.submitContent=w()(v.a.mark(function e(){return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t.state.content.toHTML();case 1:case"end":return e.stop()}},e)})),t.handleEditorChange=function(e){t.state.data.content=e.toHTML()},t.handleEditorUpload=function(e){var a="/api/admin/picture/upload",t=new XMLHttpRequest,l=new FormData,n=function(a){var l=JSON.parse(t.responseText);"success"===l.status?e.success({url:l.data.url,meta:{id:l.data.id,title:l.data.title,alt:l.data.title,loop:!0,autoPlay:!0,controls:!0,poster:l.data.url}}):e.error({msg:l.msg})},r=function(a){e.progress(a.loaded/a.total*100)},i=function(a){e.error({msg:"unable to upload."})};t.upload.addEventListener("progress",r,!1),t.addEventListener("load",n,!1),t.addEventListener("error",i,!1),t.addEventListener("abort",i,!1),l.append("file",e.file),t.open("POST",a,!0),t.setRequestHeader("Authorization","Bearer "+sessionStorage["token"]),t.send(l)},t}return T()(a,e),L()(a,[{key:"componentDidMount",value:function(){var e=this;this.setState({loading:!0});var a=this.props.location.query;this.props.dispatch({type:"model/create",payload:B()({modelName:this.modelName},a),callback:function(a){a&&e.setState({data:a.data,loading:!1})}})}},{key:"render",value:function(){var e=this,a=this.props.form.getFieldDecorator,t={labelCol:{xs:{span:24},sm:{span:2}},wrapperCol:{xs:{span:24},sm:{span:22}}},l=q.a.createElement("div",null,q.a.createElement(f["a"],{type:"plus"}),q.a.createElement("div",{className:"ant-upload-text"},"\u4e0a\u4f20\u56fe\u7247")),n={name:"file",listType:"picture-card",fileList:this.state.coverList,onPreview:function(a){e.setState({previewImage:a.url||a.thumbUrl,previewVisible:!0})},action:"/api/admin/picture/upload",headers:{authorization:"Bearer "+sessionStorage["token"]},beforeUpload:function(e){if("image/jpeg"!==e.type&&"image/png"!==e.type)return g["a"].error("\u8bf7\u4e0a\u4f20jpg\u6216png\u683c\u5f0f\u7684\u56fe\u7247!"),!1;var a=e.size/1024/1024<2;return!!a||(g["a"].error("\u56fe\u7247\u5927\u5c0f\u4e0d\u53ef\u8d85\u8fc72MB!"),!1)},onChange:function(a){var t=a.fileList;t=t.slice(-3),t=t.map(function(e){return e.response&&(e.url=e.response.data.url,e.uid=e.response.data.id),e}),t=t.filter(function(e){return!e.response||"success"===e.response.status}),e.setState({coverList:t})}},r={name:"file",action:"/api/admin/file/upload",headers:{authorization:"Bearer "+sessionStorage["token"]},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?g["a"].success("".concat(e.file.name," \u4e0a\u4f20\u6210\u529f\uff01")):"error"===e.file.status&&g["a"].error("".concat(e.file.name," \u4e0a\u4f20\u5931\u8d25\uff01"))}};return q.a.createElement(j["a"],null,q.a.createElement("div",{className:Z.a.container},q.a.createElement(z["a"],{onSubmit:this.handleSubmit},q.a.createElement(R["a"],{defaultActiveKey:"1",tabBarExtraContent:q.a.createElement("a",{href:"javascript:history.go(-1)"},"\u8fd4\u56de\u4e0a\u4e00\u9875\xa0\xa0\xa0\xa0")},q.a.createElement(W,{tab:"\u57fa\u672c",key:"1"},q.a.createElement(z["a"].Item,E()({style:{marginBottom:0}},t,{label:"\u6807\u9898"}),q.a.createElement(z["a"].Item,{style:{display:"inline-block",marginBottom:8}},a("title",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6807\u9898\uff01"}]})(q.a.createElement(Y["a"],{className:Z.a.middleItem,placeholder:"\u8bf7\u8f93\u5165\u6807\u9898"}))),q.a.createElement(z["a"].Item,{style:{display:"inline-block",marginBottom:8,marginLeft:10}},"\u7b80\u7565\u6807\u9898\uff1a",a("name")(q.a.createElement(Y["a"],{className:Z.a.smallItem,placeholder:"\u8bf7\u8f93\u5165\u7b80\u7565\u6807\u9898"})))),q.a.createElement(z["a"].Item,E()({style:{marginBottom:8}},t,{label:"\u63cf\u8ff0"}),a("description")(q.a.createElement(G,{className:Z.a.middleItem,placeholder:"\u8bf7\u8f93\u5165\u63cf\u8ff0",autosize:{minRows:3,maxRows:6}}))),q.a.createElement(z["a"].Item,E()({style:{marginBottom:8}},t,{label:"\u6807\u7b7e"}),a("tags")(q.a.createElement(Y["a"],{className:Z.a.middleItem,placeholder:"\u8bf7\u8f93\u5165\u6807\u7b7e",autosize:{minRows:3,maxRows:6}}))),q.a.createElement(z["a"].Item,E()({style:{marginBottom:0}},t,{label:"\u4f5c\u8005"}),q.a.createElement(z["a"].Item,{style:{display:"inline-block",marginBottom:8}},a("author")(q.a.createElement(Y["a"],{className:Z.a.smallItem,placeholder:"\u8bf7\u8f93\u5165\u4f5c\u8005"}))),q.a.createElement(z["a"].Item,{style:{display:"inline-block",marginBottom:8,marginLeft:10}},"\u6765\u6e90\uff1a",a("source")(q.a.createElement(Y["a"],{className:Z.a.smallItem,placeholder:"\u8bf7\u8f93\u5165\u6765\u6e90"}))),q.a.createElement(z["a"].Item,{style:{display:"inline-block",marginBottom:8,marginLeft:10}},"\u6392\u5e8f\uff1a",a("level",{initialValue:0},{rules:[{type:"number",message:"\u5fc5\u987b\u4e3a\u6570\u5b57"}]})(q.a.createElement(p["a"],{min:0,max:1e5}))," ","(\u8d8a\u5927\u8d8a\u9760\u524d)")),q.a.createElement(z["a"].Item,E()({style:{marginBottom:8}},t,{label:"\u63a8\u8350\u4f4d"}),a("position")(q.a.createElement(u["a"].Group,{style:{width:"100%"}},q.a.createElement(u["a"],{value:1},"\u9996\u9875\u63a8\u8350"),q.a.createElement(u["a"],{value:2},"\u9891\u9053\u63a8\u8350"),q.a.createElement(u["a"],{value:4},"\u5217\u8868\u63a8\u8350"),q.a.createElement(u["a"],{value:8},"\u8be6\u60c5\u63a8\u8350")))),q.a.createElement(z["a"].Item,E()({style:{marginBottom:8}},t,{label:"\u5c55\u73b0\u5f62\u5f0f"}),a("show_type",{initialValue:1})(q.a.createElement(ee,null,q.a.createElement(P["a"],{value:1},"\u65e0\u56fe"),q.a.createElement(P["a"],{value:2},"\u5355\u56fe\uff08\u5c0f\uff09"),q.a.createElement(P["a"],{value:3},"\u591a\u56fe"),q.a.createElement(P["a"],{value:4},"\u5355\u56fe\uff08\u5927\uff09")))),q.a.createElement(z["a"].Item,E()({style:{marginBottom:8}},t,{label:"\u5c01\u9762\u56fe"}),q.a.createElement(d["a"],n,this.state.coverList>=3?null:l),q.a.createElement(c["a"],{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancel},q.a.createElement("img",{style:{width:"100%"},src:this.state.previewImage}))),q.a.createElement(z["a"].Item,E()({style:{marginBottom:8}},t,{label:"\u5206\u7c7b"}),a("pid")(q.a.createElement(H["a"],{style:{width:200},placeholder:"\u9009\u62e9\u5206\u7c7b"},0!==this.state.data.categorys.length?this.state.data.categorys.map(function(e){return q.a.createElement($,{key:e.id},e.title)}):console.log("select data null")))),q.a.createElement(z["a"].Item,E()({style:{marginBottom:8}},t,{label:"\u5141\u8bb8\u8bc4\u8bba"}),a("comment_status",{initialValue:!0,valuePropName:"checked"})(q.a.createElement(m["a"],{checkedChildren:"\u662f",unCheckedChildren:"\u5426"}))),q.a.createElement(z["a"].Item,E()({style:{marginBottom:8}},t,{label:"\u5185\u5bb9"}),q.a.createElement("div",{className:Z.a.richEditor},q.a.createElement(X.a,{value:this.state.data.content,onChange:this.handleEditorChange,onSave:this.submitContent,contentStyle:{height:400,boxShadow:"inset 0 1px 3px rgba(0,0,0,.1)"},media:{uploadFn:this.handleEditorUpload}}))),q.a.createElement(z["a"].Item,E()({style:{marginBottom:8}},t,{label:"\u53d1\u5e03\u65f6\u95f4"}),a("created_at",{initialValue:J()()})(q.a.createElement(s["a"],{showTime:!0,locale:Q.a,format:"YYYY-MM-DD HH:mm:ss",placeholder:"\u8bf7\u9009\u62e9\u65f6\u95f4"})))),q.a.createElement(W,{tab:"\u6269\u5c55",key:"2"},q.a.createElement(z["a"].Item,E()({style:{marginBottom:8}},t,{label:"\u8bc4\u8bba\u91cf"}),a("comment",{initialValue:0})(q.a.createElement(p["a"],{className:Z.a.smallItem,min:0,max:1e5}))),q.a.createElement(z["a"].Item,E()({style:{marginBottom:8}},t,{label:"\u6d4f\u89c8\u91cf"}),a("view",{initialValue:0})(q.a.createElement(p["a"],{className:Z.a.smallItem,min:0,max:1e5}))),q.a.createElement(z["a"].Item,E()({style:{marginBottom:8}},t,{label:"\u8bbf\u95ee\u5bc6\u7801"}),a("password")(q.a.createElement(Y["a"],{className:Z.a.smallItem,placeholder:"\u8bf7\u8f93\u5165\u8bbf\u95ee\u5bc6\u7801"}))),q.a.createElement(z["a"].Item,E()({style:{marginBottom:8}},t,{label:"\u9644\u4ef6"}),q.a.createElement(d["a"],r,q.a.createElement(o["a"],null,q.a.createElement(f["a"],{type:"upload"})," \u4e0a\u4f20\u9644\u4ef6"))))),q.a.createElement(z["a"].Item,E()({style:{marginBottom:8}},t,{label:"\u72b6\u6001"}),a("status",{initialValue:!0,valuePropName:"checked"})(q.a.createElement(m["a"],{checkedChildren:"\u6b63\u5e38",unCheckedChildren:"\u7981\u7528"}))),q.a.createElement(z["a"].Item,{wrapperCol:{span:12,offset:5}},q.a.createElement(o["a"],{type:"primary",htmlType:"submit"},"\u63d0\u4ea4")))))}}]),a}(_["PureComponent"]),r=i))||r)||r);a["default"]=ae}}]);